var logoutTimer=function(){var a=!1,b=function(){"undefined"==typeof logoutTimer.requestURI&&(logoutTimer.requestURI="https://card.discover.com/cardmembersvcs/common/keepalive"),logoutTimer.startTimerInterval=1e3*(logoutTimer.totalLogoutTime-logoutTimer.warningInterval),window.setTimeout&&window.location&&window.location.replace&&(logoutTimer.timerTimeout=window.setTimeout(c,logoutTimer.startTimerInterval)),d()},c=function(){var a="nostatus";"chatting"===a||"interactive"===a?e():($("#time-to-log-out").text(g(logoutTimer.warningInterval)),logoutTimer.remainingTime=0,logoutTimer.popuptimer=window.setInterval(f,1e3),logoutTimer.timeoutPopup.modal("show"),$("#timeout-overlay.in .modal-body").prepend('<a href="javascript:void;" class="custom-focus" aria-hidden="">.</a>'),$("#timeout-overlay.in .modal-content").append('<a href="javascript:void;" class="custom-focus" aria-hidden="">.</a>'),$("#need-more-time-title").attr("tabindex","0").focus(),$("#timeout-overlay.in .custom-focus").on("focus",function(){setTimeout(function(){$(".modal.in #need-more-time-title").attr("tabindex","0").focus()},10)}))},d=function(){$("#staylogin").on("click",function(a){e(),$(".web-targeting-modal").length>0&&!($(".web-targeting-modal.hide").length>0)&&$("body").addClass("modal-open")})},e=function(){a||(clearTimeout(logoutTimer.timerTimeout),clearInterval(logoutTimer.popuptimer),logoutTimer.startTimerInterval=1e3*(logoutTimer.totalLogoutTime-logoutTimer.warningInterval),logoutTimer.timeoutPopup.modal("hide"),logoutTimer.idleTime=0,$.ajax({type:"POST",url:logoutTimer.requestURI,dataType:"json",headers:{"Cache-Control":"no-cache"},beforeSend:function(b){a=!0},complete:function(b){4===b.readyState&&(200===b.status?b.responseText.indexOf("keepalivefailure")>=0?h():(logoutTimer.startTimerInterval=1e3*(logoutTimer.totalLogoutTime-logoutTimer.warningInterval),logoutTimer.timerTimeout=window.setTimeout(c,logoutTimer.startTimerInterval)):h()),a=!1}}))},f=function(){var a=logoutTimer.remainingTime++,b=logoutTimer.warningInterval-a;return 0===b?void h():void $("#time-to-log-out").text(g(b))},g=function(a){var b=Math.floor(a/60),c=Math.floor(a%60);0>b&&(b=0),0>c&&(c=0),c>=0&&10>c&&(c="0"+c),consts.isDevice===!1?$("#time-to-log-out").html('<span aria-atomic="true" aria-live="assertive">'+b+'<span class="sr-only">Minute</span></span>:<span aria-atomic="true" aria-live="assertive">'+c+'<span class="sr-only">Second</span></span>'):($(".modal-body p, #time-to-log-out").attr("aria-hidden","true"),$(".modal-body .sr-only").length<=0&&$(".modal-body").append("<p class='sr-only' aria-hidden='true'>Your session is about to expire. You will be automatically logged out in 2 minutes. To continue your session, select 'Stay Logged In'.</p>"),$(".modal-body p.sr-only").attr("aria-hidden","false"),$("#time-to-log-out").html("<span>"+b+'<span class="sr-only">Minute</span></span>:<span>'+c+'<span class="sr-only">Second</span></span>'))},h=function(){$(document).trigger("beforeRedirectfromLogout"),clearInterval(logoutTimer.popuptimer),logoutTimer.timeoutPopup.modal("hide"),window.location=logoutTimer.timeoutLink};return{init:b,totalLogoutTime:600,idleTime:0,idleInterval:0,warningInterval:120,timeoutLink:"https://portal.discover.com/customersvcs/universalLogin/timeout",remainingTime:0,timeoutPopup:$("#timeout-overlay"),popuptimer:0,requestURI:$("#keepalive-url").val(),startTimerInterval:"",timerTimeout:"",keepSessionAlive:e}}();$(function(){logoutTimer.init()});