define(["require","exports","angular"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,o,n,a,l,r){var g=this;this.EaseConstant=e,this.widgetAreaService=t,this.$element=o,this.$compile=n,this.$scope=a,this.$log=l,this.stepService=r,this.isMobileCollapseEnabled=!0,this._isHighestOrderWidget=function(e,t){return e.length-1===t},this._addMobileCollapseToggleTags=function(e,t){var i=e.indexOf("-widget>"),o=e.indexOf(">",i);return e.slice(0,o)+(" is-mobile-collapsed="+t+" is-mobile-collapse-enabled="+g.isMobileCollapseEnabled)+e.slice(o)},this._injectTag=function(e){return g.widgetArea.append(e),g.widgetArea[0].lastChild},this.widgetArea=i.element(this.$element[0].querySelector(".widgetsL1page")),t.getFeatureTogglePromise().then(function(e){g.featureToggleData=e,g.enableWidgetArea=g.featureToggleData[g.EaseConstant.features.enableWidgetFramework],g.enableWidgetArea&&g.widgetArea&&t.getAccountSummaryPromise().then(function(){g.widgetAreaService.getEligibleWidgets().then(function(e){e.forEach(function(t,i){var o=g.isMobileCollapseEnabled&&!g._isHighestOrderWidget(e,i),n=g._addMobileCollapseToggleTags(t.tag,o),a=g._injectTag(n);t.lazyLoadFunction?t.lazyLoadFunction().then(function(e){e?g._compileTag(a):(g.$log.error("lazyLoadFunction failed for widget "+t.name+", deleting tag"),g._deleteTag(a))})["catch"](function(e){g.$log.error("lazyLoadFunction threw an error for widget "+t.name+", deleting tag",e),g._deleteTag(a)}):g._compileTag(a)})})})})}return e.prototype._compileTag=function(e){this.$compile(e)(this.$scope)},e.prototype._deleteTag=function(e){e.remove()},e.$inject=["EaseConstant","widgetAreaService","$element","$compile","$scope","$log","stepService"],e}();t.WidgetAreaComponentController=o,i.module("WidgetAreaModule").controller("WidgetAreaComponentController",o)});