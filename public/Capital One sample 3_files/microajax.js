/*! atomic v1.0.0 | (c) 2015 @toddmotto | https://github.com/toddmotto/atomic
Update: I've added the logic to timeout the http call
*/

!function(e,t){"function"==typeof define&&define.amd?define("microajax",t(e)):"object"==typeof exports?module.exports=t:e.atomic=t(e)}(this,function(e){"use strict";var t={},n={contentType:"application/x-www-form-urlencoded"},r=function(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return[t,e]},s=function(t,s,u){function o(){p.abort()}var i,c={success:function(){},error:function(){},always:function(){}},a=e.XMLHttpRequest||ActiveXObject,p=new a("MSXML2.XMLHTTP.3.0");n.timeout&&(i=setTimeout(o,n.timeout)),p.open(t,s,!0),p.setRequestHeader("Content-type",n.contentType),p.setRequestHeader("c1-xhr",!0),p.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.customerActivityHeader&&p.setRequestHeader("BUS_EVT_ID",n.customerActivityHeader),n.businessEventToken&&p.setRequestHeader("EVT_SYNCH_TOKEN",n.businessEventToken),void 0!==n.nativeAppHeader&&p.setRequestHeader("NATIVE_MOBILE_IND",n.nativeAppHeader),p.onreadystatechange=function(){var e;n.timeout&&clearTimeout(i),4===p.readyState&&(e=r(p),p.status>=200&&p.status<300?c.success.apply(c,e):c.error.apply(c,e),c.always.apply(c,e))},p.send(u);var f={success:function(e){return c.success=e,f},error:function(e){return c.error=e,f},always:function(e){return c.always=e,f}};return f};return t.get=function(e){return s("GET",e)},t.put=function(e,t){return s("PUT",e,t)},t.post=function(e,t){return s("POST",e,t)},t["delete"]=function(e){return s("DELETE",e)},t.setContentType=function(e){n.contentType=e},t.setTimeout=function(e){n.timeout=e},t.setCustomerActivityHeader=function(e){n.customerActivityHeader=e},t.setBusinessEventToken=function(e){n.businessEventToken=e},t.setNativeAppHeader=function(e){n.nativeAppHeader=e},t});